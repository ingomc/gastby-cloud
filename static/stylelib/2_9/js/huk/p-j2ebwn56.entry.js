import{r as e,e as i,h as s,H as t}from"./p-8988f6c5.js";import{H as h,B as n,F as l,h as a,C as r}from"./p-0afcd70e.js";const c=[{label:"Alle Themen",value:""},{label:"Wie funktioniert die HUK24?",value:"Wie funktioniert die HUK24?",id:1},{label:"Versicherung",value:"Versicherung",id:2,subCategory:[{label:"Alle Versicherungen",value:"",id:0},{label:"Fahrzeuge",value:"Versicherung - Fahrzeuge",id:101},{label:"Rechtsschutz",value:"Versicherung - Rechtsschutz",id:102},{label:"Haftpflicht",value:"Versicherung - Haftpflicht",id:103},{label:"Tierhalter",value:"Versicherung - Tierhalter",id:104},{label:"Hausrat",value:"Versicherung - Hausrat",id:105},{label:"Unfall",value:"Versicherung - Unfall",id:106},{label:"Wohngebäude",value:"Versicherung - Wohngebäude",id:107},{label:"Auslandsreisekranken",value:"Versicherung - Auslandsreisekranken",id:108},{label:"Krankenzusatz",value:"Versicherung - Krankenzusatz",id:109},{label:"Leben",value:"Versicherung - Leben",id:110},{label:"Rente",value:"Versicherung - Rente",id:111},{label:"Berufsunfähigkeit",value:"Versicherung - Berufsunfähigkeit",id:112}]},{label:"Schadenservice",value:"Schadenservice",id:3},{label:"Angebotsspeicher",value:"Angebotsspeicher",id:4},{label:"Login",value:"Login",id:5},{label:"Servicebereich Meine HUK24",value:"Servicebereich Meine HUK24",id:6},{label:"Kunden werben Kunden",value:"Kunden werben Kunden",id:7},{label:"Technische Hilfe",value:"Technische Hilfe",id:8},{label:"Datenschutz",value:"Datenschutz",id:9},{label:"Datensicherheit",value:"Datensicherheit",id:10},{label:"Feedback geben",value:"Feedback geben",id:11}],u=class{constructor(s){e(this,s),this.apiUrl="/anonymizer/api/discovery",this.searchCategory="",this.resultsPerPage=10,this.query=void 0,this.textPlaceholder="Frage eingeben",this.labelSearch="Suchen",this.overlayTitle="Informationen suchen und finden",this.textResults="Ergebnisse",this.textMore="mehr",this.labelBack="Zurück",this.searchQuery=void 0,this.stateSelectedItem=null,this.stateSelectedCategory="",this.stateSelectedSubCategory="",this.stateOffset=0,this.stateMatchingResults=0,this.stateLoadResults=!1,this.componentName="search-layer",this.sessionId="sessionId123874190",this.clientId="clientid74647",this.categories=c,this.newFetchResults=()=>{this.stateOffset=0,this.fetchResults()},this.fetchResults=()=>(this.stateLoadResults=!0,fetch(this.apiUrl,{credentials:"include",method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:this.searchQuery?this.searchQuery:this.query||"",count:this.resultsPerPage,offset:this.stateOffset,session_id:this.sessionId,client_id:this.clientId,category:this.stateSelectedSubCategory&&""!==this.stateSelectedSubCategory?this.stateSelectedSubCategory:this.stateSelectedCategory})}).catch(()=>(this.stateLoadResults=!1,Promise.reject("no search possible"))).then(e=>(this.stateLoadResults=!1,500===e.status?(this.stateItems=[],this.stateMatchingResults=0,Promise.reject("no results found")):e)).then(e=>e.json()).then(e=>{if(e&&e.result){h.trackSearch({eventLabel:this.searchQuery,eventTarget:"",eventValue:e.result.matchingResults,componentName:"",elementName:"",clickId:""}),this.stateItems=e.result.documents;const i=/<a\s+(?:[^>]*?\s+)?href=(\"textobj:\/\/)(\d*)\">/g;this.stateItems.forEach(e=>{e.html&&(e.html=e.html.replace(i,'<a href="/selfservice.do?show=1&ma=true&docid=$2" target="_blank">'))}),this.stateMatchingResults=e.result.matchingResults}})),this.loadMore=()=>{this.stateOffset=0===this.stateOffset?this.resultsPerPage:this.stateOffset+this.resultsPerPage,this.fetchResults()},this.loadBack=()=>{this.stateOffset=0===this.stateOffset?this.resultsPerPage:this.stateOffset-this.resultsPerPage,this.fetchResults()},this.onCategoryChange=e=>{this.stateSelectedSubCategory="",this.stateSelectedCategory=e,this.fetchResults()},this.renderSubSelectBox=()=>{const e=this.categories.find(e=>e.value===this.stateSelectedCategory);if(e&&e.subCategory&&e.subCategory.length>0)return this.renderSelectBox(e.subCategory,this.stateSelectedSubCategory,e=>{e&&(this.stateSelectedSubCategory=e,this.fetchResults())})},this.closed=i(this,"closed",3)}componentWillLoad(){if(this.stateSelectedCategory=this.searchCategory,-1!==this.searchCategory.indexOf(" - ")){const e=this.searchCategory.split(" - ");this.stateSelectedCategory=e[0],this.stateSelectedSubCategory=this.searchCategory}this.searchQuery=this.query,this.fetchResults()}renderSelectBox(e,i,t){return s("form",{class:n(this,"styled-select"),onSubmit:()=>!1},s("select",{class:n(this,"select"),onChange:e=>{if(!t)return this.onCategoryChange(e.target.value||"");t(e.target.value)}},e.map(e=>{let t={};return i===e.value&&(t={selected:!0}),s("option",Object.assign({},t,{value:e.value}),e.label)})),s("div",{class:n(this,"down-icon")},s("huk-icon",{clickable:!0,icon:"arrow-down--neutral-600"})))}renderSearchButton(){return s("huk-button",{loading:this.stateLoadResults,label:this.labelSearch,variant:"cta",modifier:"small forward",onClicked:()=>this.newFetchResults()})}renderResultOverview(){return s("div",{class:n(this,"view-overview")},s("div",{class:n(this,"select-box-wrapper")},this.renderSelectBox(this.categories,this.stateSelectedCategory),this.renderSubSelectBox()),s("div",{class:n(this,"field-wrapper")},s("div",{class:n(this,"input-content")},s("div",{class:n(this,"input-icon")}," ",s("huk-icon",{icon:"search"})),s("input",{type:"text",class:n(this,"input"),value:this.searchQuery,onChange:e=>{this.searchQuery=e.target.value},onKeyPress:e=>{"enter"===e.key.toLowerCase()&&(this.searchQuery=e.target.value,this.newFetchResults())},placeholder:this.textPlaceholder+"..."}),!this.breakpoint.isMobile()&&s("div",{class:n(this,"input-button")},this.renderSearchButton()))),this.breakpoint.isMobile()&&s("div",{class:n(this,"input-button--mobile")},this.renderSearchButton()),this.stateMatchingResults>0&&this.renderItems(),this.stateMatchingResults<1&&this.renderPageination())}renderItems(){if(!this.stateItems)return null;const e=0!==this.stateOffset,i=this.stateMatchingResults>=this.resultsPerPage;return s(l,null,this.renderPageination(),s("div",{class:n(this,"list")},this.stateItems.map(e=>s("div",{class:n(this,"list-item")},s("a",{onClick:()=>this.stateSelectedItem={title:e.title,content:e.html},class:n(this,"list-link")},e.title))),s("div",{class:n(this,"page-navigation",this.stateLoadResults&&"loading")},e&&s("div",{class:n(this,"page-navigation__button"),onClick:this.loadBack},this.labelBack),e&&i&&"&nbsp; | &nbsp;",i&&s("div",{class:n(this,"page-navigation__button"),onClick:this.loadMore},this.textMore,"..."))))}renderPageination(){return s("div",{class:n(this,"result-info")},s("strong",null,this.stateMatchingResults<1&&this.textResults+" 0",this.stateMatchingResults>0&&(()=>this.textResults+" "+(this.stateOffset+1))()+" - "+(()=>this.stateOffset+this.stateMatchingResults)()))}renderDetailView(){return null!==this.stateSelectedItem&&s("div",{class:n(this,"view-detail")},s("div",{class:n(this,"html-content")},s("div",{innerHTML:this.stateSelectedItem.content})),s("div",null,s("huk-button",{label:this.labelBack,modifier:"small",onClicked:()=>this.stateSelectedItem=null})))}render(){const e=a({componentName:this.componentName});return s(t,{class:e},s("huk-overlay",{"teaser-line":this.stateSelectedItem?this.stateSelectedItem.title:this.overlayTitle,onClosed:()=>{this.closed.emit()},isVisible:!0},s("div",{slot:"overlay",class:n(this,"wrapper")},null!==this.stateSelectedItem?this.renderDetailView():this.renderResultOverview())))}static get style(){return".huk-text--white{color:#fff}.huk-text--orange{color:#fba308}.huk-text--mint{color:#00abba}.huk-text--mint-dark{color:#055e5f}\@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}\@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}.search-layer__wrapper{position:relative;padding:2.5rem}.search-layer__select{outline:none}.search-layer__sub-select-box{padding:.5rem 0}.search-layer__input-button--mobile{-ms-flex-pack:end;justify-content:flex-end;display:-ms-flexbox;display:flex}.search-layer__field-wrapper{padding:.5rem 0;position:relative}.search-layer__field-wrapper .search-layer__input-content{display:-ms-flexbox;display:flex;border-radius:.375rem;font-size:23px;border:.0625rem solid #e7e9ea;padding:0 1.5rem;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}\@media (min-width:768px){.search-layer__field-wrapper .search-layer__input-content{min-width:34.0625rem}}.search-layer__field-wrapper .search-layer__input{margin-right:.5rem;outline:none;width:100%;padding:1.5rem 0 1.5rem 1.5rem;border:0}.search-layer__field-wrapper .search-layer__input-icon{font-size:48px}.search-layer__field-wrapper .search-layer__input-button huk-button{margin:0}.search-layer__list{margin:0;padding:0;list-style:none}.search-layer__list-item{display:block;padding:.5rem 0;list-style:none;border-bottom:1px solid #cbcfd2}.search-layer__list-item :before{list-style:none}.search-layer__result-info{padding:3.125rem 0 1rem}.search-layer__list-link{color:#00abba!important;cursor:pointer}.search-layer__html-content{padding:2.5rem 0;overflow:auto}.search-layer__select-box-wrapper{display:block}\@media (min-width:768px){.search-layer__select-box-wrapper{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}}.search-layer__styled-select{border:.0625rem solid #e7e9ea;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:.375rem;overflow:hidden;position:relative;width:100%;margin-bottom:1rem}.search-layer__styled-select select::-ms-expand{display:none}.search-layer__styled-select:first-child{margin-right:1rem}\@media (min-width:768px){.search-layer__styled-select{width:20.25rem;margin-bottom:0}}.search-layer__styled-select .search-layer__select{cursor:pointer;padding:1rem 1.5rem;background:transparent;border:0;font-size:19px;-webkit-appearance:none;width:100%}.search-layer__styled-select .search-layer__select :focus{outline:none}\@media (min-width:768px){.search-layer__styled-select .search-layer__select{width:20.25rem}}.search-layer__styled-select .search-layer__down-icon{pointer-events:none;position:absolute;top:30%;right:5%;font-size:19px}.search-layer__page-navigation{display:-ms-flexbox;display:flex;color:#00abba}.search-layer__page-navigation__button{font-size:16px;font-weight:700;cursor:pointer}.search-layer__page-navigation--loading{color:#e7e9ea;cursor:default}"}};!function(e,i,s,t){var h,n=arguments.length,l=n<3?i:null===t?t=Object.getOwnPropertyDescriptor(i,s):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,i,s,t);else for(var a=e.length-1;a>=0;a--)(h=e[a])&&(l=(n<3?h(l):n>3?h(i,s,l):h(i,s))||l);n>3&&l&&Object.defineProperty(i,s,l)}([r()],u.prototype,"breakpoint",void 0);export{u as huk_search_layer};